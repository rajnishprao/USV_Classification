# Automated Classification of Rat Ultrasonic Vocalizations

---

### Introduction

Rats are highly social creatures that live in large groups with established hierarchies. Social interactions between individuals involves the use of odours, whisker touch and ultrasonic vocalizations (USVs). In a previous study (Rao et al, 2014), a large dataset of >70,000 USVs were identified and manually labelled into various calltypes. Of these, the trill, complex and flat calltypes form the vast majority (~80%) of the USVs that are vocalised during social interactions. 

This project aims to train a Convolutional Neural Networks (CNN) to classify USVs into these 3 predominant calltypes. For comparision, a CNN developed for mouse USVs was also used (DeepSqueak, Coffey et al, 2019). 

### Methods

#### Data Acquisition

Rats were placed on two elevated platforms separated by a gap. Spontaneous facial interactions that consist of extensive whisker-to-whisker & snout-to-snout touch events were recorded using low-and high-speed cameras under infra-red illumination. Ultrasonic vocalisations were recorded by specialized microphones and saved as .wav files (Rao et al, 2014).

#### Digital Signal Processing

.wav files were processed with a band pass filter (to remove low frequency noise) and compute power spectral density (to detect lack of signal) in each of the microphones. Spectrograms of a fixed duration from the onset of each USV (100 ms) were generated by fast Fourier transformation. The SciPy package was used for these steps. Spectrograms were manually checked for noise and saved into directories as required by the Keras flow_from_directory method. 

(Due to size constraints, only a few sample spectrograms are provided in this repository)

#### Convolutional Neural Networks 

The CNNs are implemented in Python on a Keras backend to train on an AMD GPU (using PlaidML, much thanks to Ricardo Di Sipio). The code can be used to run on a TensorFlow backend by simply commenting out the 'Activate Keras backend' line and replacing all "import keras..."statements with "import tensorflow.keras...".

#### Installation

```bash
conda create -n usv_classification pip python=3.6.10
conda activate usv_classification
conda install -y -c conda-forge tensorflow
pip install -r requirements.txt
```

![spiced_final_project_git 001](https://user-images.githubusercontent.com/60617095/91073626-a2fa6800-e63b-11ea-8322-58dac80106ad.png)
![spiced_final_project_git 002](https://user-images.githubusercontent.com/60617095/91073629-a42b9500-e63b-11ea-8fab-0440cd946395.png)

![spiced_final_project_git 004](https://user-images.githubusercontent.com/60617095/91073638-a68def00-e63b-11ea-9cc3-b8cfa5fb82d8.png)

![spiced_final_project_git 007](https://user-images.githubusercontent.com/60617095/91073644-a857b280-e63b-11ea-9381-cc058b80b069.png)
![spiced_final_project_git 008](https://user-images.githubusercontent.com/60617095/91073646-a8f04900-e63b-11ea-9fe8-41add5fd5e88.png)
![spiced_final_project_git 009](https://user-images.githubusercontent.com/60617095/91073647-a8f04900-e63b-11ea-9717-3702c9f74989.png)
![spiced_final_project_git 010](https://user-images.githubusercontent.com/60617095/91073648-a988df80-e63b-11ea-8ab8-94f9f8920d24.png)
![spiced_final_project_git 011](https://user-images.githubusercontent.com/60617095/91073649-a988df80-e63b-11ea-8fc7-e1b75c8c8841.png)
![spiced_final_project_git 012](https://user-images.githubusercontent.com/60617095/91073650-aa217600-e63b-11ea-8bdc-b9d84c866355.png)
![spiced_final_project_git 013](https://user-images.githubusercontent.com/60617095/91073652-aa217600-e63b-11ea-9ec5-7c1ccb9a9540.png)
![spiced_final_project_git 014](https://user-images.githubusercontent.com/60617095/91073653-aaba0c80-e63b-11ea-8964-b23ea82dcddb.png)
![spiced_final_project_git 015](https://user-images.githubusercontent.com/60617095/91073656-aaba0c80-e63b-11ea-83ce-43b6f525a882.png)
![spiced_final_project_git 016](https://user-images.githubusercontent.com/60617095/91073658-ab52a300-e63b-11ea-8e4f-2cf8a17afc27.png)
![spiced_final_project_git 017](https://user-images.githubusercontent.com/60617095/91073661-abeb3980-e63b-11ea-91d3-ea8de813250d.png)
![spiced_final_project_git 018](https://user-images.githubusercontent.com/60617095/91073662-abeb3980-e63b-11ea-82a4-4dc3f6c1f086.png)